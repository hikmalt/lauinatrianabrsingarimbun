<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday, Lauina!</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="icon" type="image/x-icon" href="/selfies/7.png">

    <style>
        /* Custom CSS for animations and specific styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f1f1;
            color: #333;
        }

        .font-heading {
            font-family: 'Playfair Display', serif;
        }

        #hero-header {
            transition: background-image 1s ease-in-out;
        }

        /* Keyframe animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes candle-flicker {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(1.05); }
        }

        @keyframes candle-out {
            to { opacity: 0; transform: scale(0.5); }
        }

        .animate-fade-in {
            animation: fadeIn 1s ease-out forwards;
        }

        /* Candle styles */
        .candle {
            width: 12px;
            height: 80px;
            background: #fff;
            border-radius: 6px 6px 0 0;
            position: relative;
            margin: 0 10px;
            box-shadow: 0 0 5px rgba(0,0,0,0.2);
        }

        .candle::before {
            content: '';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 22px;
            background: orange;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            animation: candle-flicker 1.5s ease-in-out infinite;
        }
        
        /* Ensure videos in timeline and carousel maintain aspect ratio without being cropped */
        .media-fit {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        /* --- NEW TIMELINE STYLES --- */
        .timeline-scroller {
            white-space: nowrap;
            display: flex;
            animation: scroll-left 120s linear infinite; /* Increased duration for slower scroll */
        }
        
        .timeline-item-lg {
            flex-shrink: 0;
            width: 250px; /* Larger size */
            height: 250px; /* Larger size */
            margin-right: 20px;
        }

        @keyframes scroll-left {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-200%); } /* Scrolls a bit further to create a gap */
        }
        
        /* Stop animation on hover */
        .timeline-scroller:hover {
            animation-play-state: paused;
        }
        /* --- END OF NEW TIMELINE STYLES --- */

    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <audio id="birthday-song" src="musics/HappyBirthdayCrowd.mp3"></audio>
    <audio id="background-music" loop src="musics/A Thousand Years - Christina Perri.mp3"></audio>

    <header id="hero-header" class="min-h-screen bg-cover bg-center flex flex-col items-center justify-center text-center p-8 text-white" style="background-image: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://placehold.co/1920x1080/e2e8f0/333?text=Lauina');">
        <h1 class="font-heading text-6xl md:text-8xl animate-fade-in">Lauina Triana</h1>
        <p class="text-2xl md:text-4xl mt-4 animate-fade-in" style="animation-delay: 0.3s;">Happy Birthday!</p>
        <button id="play-music-btn" class="mt-8 px-6 py-3 bg-white text-gray-800 font-bold rounded-full shadow-lg hover:bg-gray-200 transition-transform transform hover:scale-105 animate-fade-in" style="animation-delay: 0.6s;">
            <i class="fas fa-play mr-2"></i> Tekan ini dulu oii
        </button>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8">
        
        <section class="py-16">
            <h2 class="font-heading text-4xl text-center mb-8">Throwback Memories</h2>
            <div class="swiper-container w-full h-[60vh] rounded-lg shadow-xl">
                <div class="swiper-wrapper" id="carousel-wrapper">
                    </div>
                <div class="swiper-pagination"></div>
                <div class="swiper-button-next text-white"></div>
                <div class="swiper-button-prev text-white"></div>
            </div>
            <div class="text-center mt-8">
                <button id="timelapse-btn" class="px-8 py-4 bg-gray-800 text-white font-bold rounded-full shadow-lg hover:bg-gray-700 transition-transform transform hover:scale-105">
                    <i class="fas fa-film mr-2"></i> Play Memories Timelapse
                </button>
            </div>
        </section>

        <section class="py-16 bg-white rounded-lg shadow-lg my-16">
            <h2 class="font-heading text-4xl text-center mb-12">Make a Wish!</h2>
            <div id="cake-container" class="relative flex justify-center items-end h-64">
                <div id="candles" class="flex justify-center transition-opacity duration-1000">
                    <div class="candle"></div>
                    <div class="candle"></div>
                    <div class="candle"></div>
                    <div class="candle"></div>
                    <div class="candle"></div>
                </div>
                <div class="absolute bottom-0 h-32 w-80 bg-pink-200 rounded-t-lg shadow-inner"></div>
                <div class="absolute bottom-0 h-16 w-96 bg-pink-300 rounded-lg shadow-lg"></div>
                 <div id="birthday-text" class="absolute inset-0 flex items-center justify-center opacity-0 transition-opacity duration-1000">
                    <p class="font-heading text-5xl text-pink-500">Happy Birthday!</p>
                </div>
            </div>
            <div class="text-center mt-8">
                <button id="blow-candles-btn" class="px-6 py-3 bg-pink-500 text-white font-bold rounded-full shadow-lg hover:bg-pink-600 transition-transform transform hover:scale-105">
                    Blow the Candles
                </button>
            </div>
        </section>

        <section class="py-16">
            <h2 class="font-heading text-4xl text-center mb-8">Your Journey Timeline</h2>
            <div class="timeline-scroller-container w-full bg-gray-200 p-4 rounded-lg shadow-inner overflow-hidden">
                <div id="timeline-container" class="timeline-scroller">
                    </div>
            </div>
        </section>
        
        <section class="py-16 grid grid-cols-1 md:grid-cols-2 gap-12">
            <div class="text-center flex flex-col items-center">
                <h3 class="font-heading text-3xl mb-4">A Gift For You</h3>
                <div id="present-btn" class="w-32 h-32 text-6xl bg-white rounded-full shadow-xl flex items-center justify-center cursor-pointer hover:bg-red-100 transition-colors transform hover:scale-110">
                    <i class="fas fa-gift text-red-400"></i>
                </div>
            </div>
            <div class="text-center flex flex-col items-center">
                <h3 class="font-heading text-3xl mb-4">A Letter For You</h3>
                <div id="letter-btn" class="w-32 h-32 text-6xl bg-white rounded-full shadow-xl flex flex-col items-center justify-center cursor-pointer hover:bg-blue-100 transition-colors transform hover:scale-110">
                    <i class="fas fa-envelope text-blue-400"></i>
                    <span class="text-sm font-bold mt-1">Click Here</span>
                </div>
            </div>
        </section>
    </main>

    <footer class="text-center py-8 bg-gray-800 text-white mt-16">
        <p>With Love and Best Wishes on Your Special Day.</p>
    </footer>

    <div id="timelapse-overlay" class="fixed inset-0 bg-black bg-opacity-95 z-50 hidden flex-col items-center justify-center text-white p-4">
        <button id="close-timelapse-btn" class="absolute top-4 right-4 text-4xl">&times;</button>
        <div id="timelapse-content" class="w-full h-full flex items-center justify-center">
            </div>
    </div>

    <div id="media-viewer-overlay" class="fixed inset-0 bg-black bg-opacity-90 z-50 hidden items-center justify-center p-4">
           <button id="close-media-viewer-btn" class="absolute top-4 right-4 text-4xl text-white">&times;</button>
        <div id="media-viewer-content" class="max-w-4xl max-h-[80vh]">
            </div>
    </div>
    
    <div id="present-overlay" class="fixed inset-0 bg-black bg-opacity-80 z-50 hidden items-center justify-center p-4">
        <button id="close-present-btn" class="absolute top-4 right-4 text-4xl text-white">&times;</button>
        <div class="bg-white p-6 rounded-lg shadow-2xl text-center">
            <h3 class="font-heading text-2xl mb-4">Flower For You!</h3>
            <img src="https://thumbs.dreamstime.com/b/kind-senior-gentleman-giving-flowers-to-someone-looking-camera-isolated-white-background-52183546.jpg" alt="A flower for you" class="max-w-sm mx-auto rounded-lg">
        </div>
    </div>
    
    <div id="letter-overlay" class="fixed inset-0 bg-black bg-opacity-80 z-50 hidden items-center justify-center p-4">
        <button id="close-letter-btn" class="absolute top-4 right-4 text-4xl text-white">&times;</button>
        <div id="letter-content" class="bg-white p-8 rounded-lg shadow-2xl text-center max-w-lg w-full">
            <p class="text-lg mb-6">Hi Lauina, it's me hikmal</p>
            <p class="mb-8">Happy birthday yaw, semoga yang disemogakan tercapai... <br>
                actually i have crush on u, i think u already now that right..., <br>
                i hope we can know each other better maybe? but it was fine if u dont want to<br>
                please dont be ilfeel, its fine all of your photos and videos already deleted<br>
                i just wanna make this website<br>
                btw sorry for add friend ur fb yesterday, cause i just wanna save more photo for this website <br>
            </p>
            <div class="flex justify-center space-x-4">
                <button id="accept-btn" class="px-6 py-2 bg-green-500 text-white font-bold rounded-full hover:bg-green-600 transition">Accept</button>
                <button id="reject-btn" class="px-6 py-2 bg-red-500 text-white font-bold rounded-full hover:bg-red-600 transition">Reject</button>
            </div>
        </div>
    </div>

    <div id="notification-toast" class="fixed bottom-5 right-5 bg-gray-800 text-white px-6 py-3 rounded-lg shadow-xl opacity-0 transform translate-y-10 transition-all duration-500">
        <p>Alright, thank you. It's fine, don't be 'ilfeel'.</p>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- IMPORTANT: MEDIA FILE SETUP ---
    // The code now uses your local file paths directly.
    const mediaFiles = [
        { type: 'image', src: 'bornbaby/1.png', category: 'Baby' },
        { type: 'image', src: 'college/bukber2025/1.png', category: 'College' },
        { type: 'image', src: 'college/bukber2025/2.png', category: 'College' },
        { type: 'image', src: 'college/bukber2025/3.png', category: 'College' },
        { type: 'image', src: 'college/bukber2025/4.png', category: 'College' },
        { type: 'image', src: 'college/bukber2025/5.png', category: 'College' },
        { type: 'image', src: 'college/bukber2025/6.png', category: 'College' },
        { type: 'image', src: 'college/bukber2025/7.png', category: 'College' },
        { type: 'image', src: 'college/bukber2025/8.png', category: 'College' },
        { type: 'image', src: 'college/bukber2025/9.png', category: 'College' },
        { type: 'image', src: 'college/bukber2025/10.png', category: 'College' },
        { type: 'image', src: 'college/bukber2025/11.png', category: 'College' },
        { type: 'image', src: 'college/bukber2025/12.png', category: 'College' },
        { type: 'image', src: 'college/bukber2025/13.png', category: 'College' },
        { type: 'image', src: 'college/hmpsce/1.png', category: 'College' },
        { type: 'image', src: 'college/hmpsce/2.png', category: 'College' },
        { type: 'image', src: 'college/hmpsce/3.png', category: 'College' },
        { type: 'image', src: 'college/hmpsce/4.png', category: 'College' },
        { type: 'image', src: 'college/hmpsce/5.png', category: 'College' },
        { type: 'image', src: 'college/hmpsce/6.png', category: 'College' },
        { type: 'image', src: 'college/hmpsce/7.png', category: 'College' },
        { type: 'image', src: 'college/hmpsce/8.png', category: 'College' },
        { type: 'image', src: 'college/hmpsce/9.png', category: 'College' },
        { type: 'image', src: 'college/hmpsce/10.png', category: 'College' },
        { type: 'image', src: 'college/hmpsce/11.png', category: 'College' },
        { type: 'image', src: 'college/hmpsce/12.png', category: 'College' },
        { type: 'image', src: 'college/hmpsce/13.png', category: 'College' },
        { type: 'image', src: 'college/hmpsce/14.png', category: 'College' },
        { type: 'image', src: 'college/outboundce/1.png', category: 'College' },
        { type: 'image', src: 'college/outboundce/2.png', category: 'College' },
        { type: 'image', src: 'college/outboundce/3.png', category: 'College' },
        { type: 'image', src: 'college/random/1.png', category: 'College' },
        { type: 'image', src: 'college/random/2.png', category: 'College' },
        { type: 'image', src: 'college/random/3.png', category: 'College' },
        { type: 'image', src: 'college/random/4.png', category: 'College' },
        { type: 'image', src: 'college/random/5.png', category: 'College' },
        { type: 'image', src: 'college/random/6.png', category: 'College' },
        { type: 'image', src: 'college/random/7.png', category: 'College' },
        { type: 'image', src: 'college/random/8.png', category: 'College' },
        { type: 'image', src: 'college/random/9.png', category: 'College' },
        { type: 'image', src: 'college/random/10.png', category: 'College' },
        { type: 'image', src: 'college/rindam/1.png', category: 'College' },
        { type: 'image', src: 'college/rindam/2.png', category: 'College' },
        { type: 'image', src: 'college/rindam/3.png', category: 'College' },
        { type: 'image', src: 'college/semester1/1.png', category: 'College' },
        { type: 'image', src: 'college/semester1/2.png', category: 'College' },
        { type: 'image', src: 'college/semester1/3.png', category: 'College' },
        { type: 'image', src: 'college/semester1/4.png', category: 'College' },
        { type: 'image', src: 'college/semester1/5.png', category: 'College' },
        { type: 'image', src: 'college/semester1/6.png', category: 'College' },
        { type: 'image', src: 'college/semester1/7.png', category: 'College' },
        { type: 'image', src: 'college/semester1/8.png', category: 'College' },
        { type: 'image', src: 'college/semester1/9.png', category: 'College' },
        { type: 'image', src: 'college/semester1/10.png', category: 'College' },
        { type: 'image', src: 'college/semester1/11.png', category: 'College' },
        { type: 'image', src: 'college/semester1/12.png', category: 'College' },
        { type: 'image', src: 'college/semester1/13.png', category: 'College' },
        { type: 'image', src: 'college/semester1/14.png', category: 'College' },
        { type: 'image', src: 'college/semester1/15.png', category: 'College' },
        { type: 'image', src: 'college/semester2/1.png', category: 'College' },
        { type: 'image', src: 'college/semester3/1.png', category: 'College' },
        { type: 'image', src: 'college/semester3/2.png', category: 'College' },
        { type: 'image', src: 'college/semester3/3.png', category: 'College' },
        { type: 'image', src: 'college/semester3/4.png', category: 'College' },
        { type: 'image', src: 'college/semester3/5.png', category: 'College' },
        { type: 'image', src: 'college/semester4/1.png', category: 'College' },
        { type: 'image', src: 'college/semester4/2.png', category: 'College' },
        { type: 'image', src: 'college/semester4/3.png', category: 'College' },
        { type: 'image', src: 'college/semester4/4.png', category: 'College' },
        { type: 'image', src: 'college/semester4/5.png', category: 'College' },
        { type: 'image', src: 'college/semester4/6.png', category: 'College' },
        { type: 'image', src: 'college/semester4/7.png', category: 'College' },
        { type: 'image', src: 'college/semester4/8.png', category: 'College' },
        { type: 'image', src: 'college/semester4/9.png', category: 'College' },
        { type: 'image', src: 'college/semester4/10.png', category: 'College' },
        { type: 'image', src: 'college/semester4/11.png', category: 'College' },
        { type: 'image', src: 'college/semester4/12.png', category: 'College' },
        { type: 'image', src: 'college/semester4/13.png', category: 'College' },
        { type: 'image', src: 'college/semester4/14.png', category: 'College' },
        { type: 'image', src: 'college/semester4/15.png', category: 'College' },
        { type: 'image', src: 'college/semester4/16.png', category: 'College' },
        { type: 'image', src: 'college/semester4/17.png', category: 'College' },
        { type: 'image', src: 'college/semester4/18.png', category: 'College' },
        { type: 'image', src: 'college/semester4/19.png', category: 'College' },
        { type: 'image', src: 'college/semester4/20.png', category: 'College' },
        { type: 'image', src: 'college/semester4/21.png', category: 'College' },
        { type: 'video', src: 'college/taskvideos/1.mp4', category: 'College' },
        { type: 'video', src: 'college/taskvideos/2.mp4', category: 'College' },
        { type: 'video', src: 'college/taskvideos/3.mp4', category: 'College' },
        { type: 'video', src: 'college/taskvideos/4.mp4', category: 'College' },
        { type: 'video', src: 'college/taskvideos/5.mp4', category: 'College' },
        { type: 'video', src: 'college/taskvideos/6.mp4', category: 'College' },
        { type: 'video', src: 'college/taskvideos/7.mp4', category: 'College' },
        { type: 'video', src: 'college/taskvideos/8.mp4', category: 'College' },
        { type: 'video', src: 'college/taskvideos/9.mp4', category: 'College' },
        { type: 'video', src: 'kid/1.mp4', category: 'Kid' },
        { type: 'image', src: 'kid/1.png', category: 'Kid' },
        { type: 'image', src: 'kid/2.png', category: 'Kid' },
        { type: 'image', src: 'martialarts/1.png', category: 'Martial Arts' },
        { type: 'image', src: 'martialarts/2.png', category: 'Martial Arts' },
        { type: 'image', src: 'selfies/1.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/2.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/3.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/4.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/5.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/6.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/7.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/8.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/9.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/10.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/11.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/12.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/13.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/14.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/15.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/16.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/17.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/18.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/19.png', category: 'Selfies' },
        { type: 'image', src: 'selfies/20.png', category: 'Selfies' },
        { type: 'video', src: 'smp/1.mp4', category: 'SMP' },
    ];
    
    // --- AUDIO LOGIC ---
    const birthdaySong = document.getElementById('birthday-song');
    const backgroundMusic = document.getElementById('background-music');
    const playMusicBtn = document.getElementById('play-music-btn');
    let musicHasStarted = false;

    playMusicBtn.addEventListener('click', () => {
        // If music has never been started, begin the sequence
        if (!musicHasStarted) {
            musicHasStarted = true;
            birthdaySong.play().catch(e => console.error("Browser prevented autoplay:", e));
            playMusicBtn.innerHTML = '<i class="fas fa-pause mr-2"></i> Pause Music';
            return;
        }

        // If music has started, toggle pause/resume
        const isBirthdaySongPlaying = !birthdaySong.paused && !birthdaySong.ended;
        const isBackgroundMusicPlaying = !backgroundMusic.paused;

        if (isBirthdaySongPlaying) {
            birthdaySong.pause();
            playMusicBtn.innerHTML = '<i class="fas fa-play mr-2"></i> Resume Music';
        } else if (isBackgroundMusicPlaying) {
            backgroundMusic.pause();
            playMusicBtn.innerHTML = '<i class="fas fa-play mr-2"></i> Resume Music';
        } else {
            // Resume whichever song was playing last or is next in sequence
            if (!birthdaySong.ended) {
                birthdaySong.play();
            } else {
                backgroundMusic.play();
            }
            playMusicBtn.innerHTML = '<i class="fas fa-pause mr-2"></i> Pause Music';
        }
    });

    birthdaySong.addEventListener('ended', () => {
        backgroundMusic.currentTime = 10; // Start from 00:10
        backgroundMusic.play();
        // Keep button state consistent
        playMusicBtn.innerHTML = '<i class="fas fa-pause mr-2"></i> Pause Music';
    });


    // --- HEADER BACKGROUND SLIDESHOW ---
    const heroHeader = document.getElementById('hero-header');
    const imageFiles = mediaFiles
        .filter(file => file.type === 'image')
        .map(file => file.src); // Use local paths directly

    if (imageFiles.length > 0) {
        let currentImageIndex = 0;
        // Set initial background image
        heroHeader.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('${imageFiles[0]}')`;
        
        setInterval(() => {
            currentImageIndex = (currentImageIndex + 1) % imageFiles.length;
            const nextImageUrl = imageFiles[currentImageIndex];
            
            // Preload the next image to ensure smooth transition
            const tempImg = new Image();
            tempImg.src = nextImageUrl;
            tempImg.onload = () => {
                heroHeader.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('${nextImageUrl}')`;
            };
        }, 5000); // Change image every 5 seconds
    }


    // --- CAROUSEL LOGIC ---
    const carouselWrapper = document.getElementById('carousel-wrapper');
    mediaFiles.forEach(file => {
        const slide = document.createElement('div');
        slide.className = 'swiper-slide bg-black flex items-center justify-center';
        if (file.type === 'image') {
            slide.innerHTML = `<img src="${file.src}" alt="Memory" class="media-fit">`;
        } else {
            slide.innerHTML = `<video src="${file.src}" class="media-fit" controls></video>`;
        }
        carouselWrapper.appendChild(slide);
    });

    const swiper = new Swiper('.swiper-container', {
        loop: true,
        pagination: {
            el: '.swiper-pagination',
            clickable: true,
        },
        navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
        },
        autoplay: {
            delay: 3000,
            disableOnInteraction: false,
        },
    });

    // --- TIMELAPSE LOGIC ---
    const timelapseBtn = document.getElementById('timelapse-btn');
    const timelapseOverlay = document.getElementById('timelapse-overlay');
    const closeTimelapseBtn = document.getElementById('close-timelapse-btn');
    const timelapseContent = document.getElementById('timelapse-content');
    let timelapseTimeout;

    function playTimelapse(index = 0) {
        if (index >= mediaFiles.length) {
            timelapseContent.innerHTML = `<p class="text-3xl font-heading">The End</p>`;
            clearTimeout(timelapseTimeout);
            return;
        }

        const file = mediaFiles[index];
        let elementHTML;
        const duration = file.type === 'image' ? 2000 : 10000;

        if (file.type === 'image') {
            elementHTML = `<img src="${file.src}" alt="Timelapse Memory" class="max-w-full max-h-full filter grayscale animate-fade-in">`;
        } else {
            elementHTML = `<video src="${file.src}" class="max-w-full max-h-full filter grayscale" autoplay muted></video>`;
        }
        timelapseContent.innerHTML = elementHTML;

        timelapseTimeout = setTimeout(() => playTimelapse(index + 1), duration);
    }
    
    timelapseBtn.addEventListener('click', () => {
        timelapseOverlay.style.display = 'flex';
        playTimelapse();
    });

    closeTimelapseBtn.addEventListener('click', () => {
        timelapseOverlay.style.display = 'none';
        timelapseContent.innerHTML = '';
        clearTimeout(timelapseTimeout);
    });

    // --- CAKE & CANDLES LOGIC ---
    const blowCandlesBtn = document.getElementById('blow-candles-btn');
    const candles = document.getElementById('candles');
    const birthdayText = document.getElementById('birthday-text');

    blowCandlesBtn.addEventListener('click', () => {
        candles.style.opacity = '0';
        setTimeout(() => {
            birthdayText.style.opacity = '1';
        }, 500);
        blowCandlesBtn.disabled = true;
    });

    // --- TIMELINE LOGIC ---
    const timelineContainer = document.getElementById('timeline-container');
    const mediaViewerOverlay = document.getElementById('media-viewer-overlay');
    const mediaViewerContent = document.getElementById('media-viewer-content');
    const closeMediaViewerBtn = document.getElementById('close-media-viewer-btn');
    
    // Duplicate media files to ensure continuous loop without a visible gap
    const loopedMediaFiles = [...mediaFiles, ...mediaFiles];

    loopedMediaFiles.forEach(file => {
        const item = document.createElement('div');
        item.className = 'timeline-item-lg bg-white rounded-lg shadow-md cursor-pointer overflow-hidden transform hover:scale-105 transition';
        if (file.type === 'image') {
            item.innerHTML = `<img src="${file.src}" class="w-full h-full object-cover" alt="Timeline thumbnail">`;
        } else {
            item.innerHTML = `<video src="${file.src}" class="w-full h-full object-cover"></video><div class="absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center"><i class="fas fa-play text-white text-3xl"></i></div>`;
            item.classList.add('relative');
        }
        item.addEventListener('click', () => {
            if (file.type === 'image') {
                mediaViewerContent.innerHTML = `<img src="${file.src}" alt="Memory" class="max-w-full max-h-[80vh] rounded-lg">`;
            } else {
                mediaViewerContent.innerHTML = `<video src="${file.src}" class="max-w-full max-h-[80vh] rounded-lg" controls autoplay></video>`;
            }
            mediaViewerOverlay.style.display = 'flex';
        });
        timelineContainer.appendChild(item);
    });

    closeMediaViewerBtn.addEventListener('click', () => {
        mediaViewerOverlay.style.display = 'none';
        mediaViewerContent.innerHTML = '';
    });

    // --- MODAL LOGIC (PRESENT & LETTER) ---
    const presentBtn = document.getElementById('present-btn');
    const presentOverlay = document.getElementById('present-overlay');
    const closePresentBtn = document.getElementById('close-present-btn');
    
    const letterBtn = document.getElementById('letter-btn');
    const letterOverlay = document.getElementById('letter-overlay');
    const closeLetterBtn = document.getElementById('close-letter-btn');

    presentBtn.addEventListener('click', () => presentOverlay.style.display = 'flex');
    closePresentBtn.addEventListener('click', () => presentOverlay.style.display = 'none');

    letterBtn.addEventListener('click', () => letterOverlay.style.display = 'flex');
    closeLetterBtn.addEventListener('click', () => letterOverlay.style.display = 'none');
    
    // --- LETTER BUTTONS LOGIC ---
    const acceptBtn = document.getElementById('accept-btn');
    const rejectBtn = document.getElementById('reject-btn');
    const notificationToast = document.getElementById('notification-toast');
    
    acceptBtn.addEventListener('click', () => {
        // IMPORTANT: Replace 'YOUR_PHONE_NUMBER' with the target WhatsApp number, e.g., '6281234567890'
        const phoneNumber = 'YOUR_PHONE_NUMBER';
        const message = encodeURIComponent('I accept.');
        window.open(`https://wa.me/${62895629471997}?text=${message}`, '_blank');
    });
    
    rejectBtn.addEventListener('click', () => {
        letterOverlay.style.display = 'none';
        notificationToast.style.opacity = '1';
        notificationToast.style.transform = 'translateY(0)';
        
        setTimeout(() => {
            notificationToast.style.opacity = '0';
            notificationToast.style.transform = 'translateY(10px)';
            // Fade out the main content as a visual effect
            document.querySelector('main').style.transition = 'opacity 2s';
            document.querySelector('main').style.opacity = '0.1';
            document.getElementById('letter-content').innerHTML = `<p>All your photo and video are deleted.</p>`;
        }, 4000);
    });
});
</script>

</body>
</html>